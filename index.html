<!DOCTYPE html>
<html>
<title>Dwarf Fortress Work Orders Manager</title>

<head>
	<meta http-equiv="Content-Security-Policy"
		content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline';">
	<link rel="stylesheet" href="style.css">
	<script src="node_modules/fuse.js/dist/fuse.js"></script>
	<script src="df-pom-ordersdata.js"></script>
	<script src="df-pom.js"></script>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
</head>

<body>
	<div class="base">
		<div class="contentBackdrop"></div>
		<div class="contentHead">

			<div class="traces">
				<button id="hideLogs" onclick="ToggleOption('HideLogs')">
					<span class="ico"><svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960"
							width="24px" fill="#e3e3e3">
							<path
								d="M480-200q66 0 113-47t47-113v-160q0-66-47-113t-113-47q-66 0-113 47t-47 113v160q0 66 47 113t113 47Zm-80-120h160v-80H400v80Zm0-160h160v-80H400v80Zm80 40Zm0 320q-65 0-120.5-32T272-240H160v-80h84q-3-20-3.5-40t-.5-40h-80v-80h80q0-20 .5-40t3.5-40h-84v-80h112q14-23 31.5-43t40.5-35l-64-66 56-56 86 86q28-9 57-9t57 9l88-86 56 56-66 66q23 15 41.5 34.5T688-640h112v80h-84q3 20 3.5 40t.5 40h80v80h-80q0 20-.5 40t-3.5 40h84v80H688q-32 56-87.5 88T480-120Z" />
						</svg>
					</span>
					<span class="keyInfo">(CTRL+1)</span>
				</button>
			</div>

			<div class="tabs">
				<button id="tabRaw" onclick="SetTab('raw')">
					<span class="ico"><svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960"
							width="24px" fill="#e3e3e3">
							<path
								d="M280-600v-80h560v80H280Zm0 160v-80h560v80H280Zm0 160v-80h560v80H280ZM160-600q-17 0-28.5-11.5T120-640q0-17 11.5-28.5T160-680q17 0 28.5 11.5T200-640q0 17-11.5 28.5T160-600Zm0 160q-17 0-28.5-11.5T120-480q0-17 11.5-28.5T160-520q17 0 28.5 11.5T200-480q0 17-11.5 28.5T160-440Zm0 160q-17 0-28.5-11.5T120-320q0-17 11.5-28.5T160-360q17 0 28.5 11.5T200-320q0 17-11.5 28.5T160-280Z" />
						</svg></span>
					<span>PRODUCTION</span>
					<span class="keyInfo">â‡† (CTRL+W)</span>
				</button>
				<div class="sep"> </div>
				<button id="tabBoard" onclick="SetTab('board')">
					<span class="ico"><svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960"
							width="24px" fill="#e3e3e3">
							<path
								d="M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h133v-133H200v133Zm213 0h134v-133H413v133Zm214 0h133v-133H627v133ZM200-413h133v-134H200v134Zm213 0h134v-134H413v134Zm214 0h133v-134H627v134ZM200-627h133v-133H200v133Zm213 0h134v-133H413v133Zm214 0h133v-133H627v133Z" />
						</svg></span>
					<span>STOCKS</span>
					<span class="keyInfo">â‡† (CTRL+W)</span>
				</button>
			</div>
		</div>

		<div class='rawMode hidden'>

			<div class="tools">
				<button id="readOrders" onclick="ReadOrders(true)" title="Read production orders from Dwarf Fortress">
					<span class='ico'>â¯ˆ</span>
					<span class='txt'>READ</span>
					<span class="keyInfo">(CTRL+R)</span>
				</button>
				<button id="autoReadOrders" onclick="ToggleOption('AutoReadOrders')"
					title="Toggle automatic reading of production orders from Dwarf Fortress">
					<span class='ico'><svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960"
							width="24px" fill="#e3e3e3">
							<path
								d="M204-318q-22-38-33-78t-11-82q0-134 93-228t227-94h7l-64-64 56-56 160 160-160 160-56-56 64-64h-7q-100 0-170 70.5T240-478q0 26 6 51t18 49l-60 60ZM481-40 321-200l160-160 56 56-64 64h7q100 0 170-70.5T720-482q0-26-6-51t-18-49l60-60q22 38 33 78t11 82q0 134-93 228t-227 94h-7l64 64-56 56Z" />
						</svg></span>
					<span class="keyInfo">(SHIFT+CTRL+R)</span>
				</button>

				<div class="sep"> </div>
				<button id="saveOrders" onclick="QueueOrdersSave(true)"
					title="Apply production orders changes to Dwarf Fortress">
					<span class='ico'>ðŸ–«</span>
					<span class='txt'>SAVE</span>
					<span class="keyInfo">(CTRL+S)</span>
				</button>

				<button id="autoSaveOrders" onclick="ToggleOption('AutoSaveOrders')"
					title="Toggle automatic saving of production orders to Dwarf Fortress">
					<span class="ico">
						<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px"
							fill="#e3e3e3">
							<path
								d="M204-318q-22-38-33-78t-11-82q0-134 93-228t227-94h7l-64-64 56-56 160 160-160 160-56-56 64-64h-7q-100 0-170 70.5T240-478q0 26 6 51t18 49l-60 60ZM481-40 321-200l160-160 56 56-64 64h7q100 0 170-70.5T720-482q0-26-6-51t-18-49l60-60q22 38 33 78t11 82q0 134-93 228t-227 94h-7l64 64-56 56Z" />
						</svg></span>
					<span class="keyInfo">(SHIFT+CTRL+S)</span>
				</button>

				<div class="sep"> </div>
				<button id="cancelOrders" onclick="CancelOrderChanges()"
					title="Cancel all unsaved changes to production orders">
					<span class='ico'>
						<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px"
							fill="#e3e3e3">
							<path
								d="M480-80q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-80q54 0 104-17.5t92-50.5L228-676q-33 42-50.5 92T160-480q0 134 93 227t227 93Zm252-124q33-42 50.5-92T800-480q0-134-93-227t-227-93q-54 0-104 17.5T284-732l448 448ZM480-480Z" />
						</svg>
					</span>
					<span class="keyInfo">(CTRL+Z)</span>
				</button>

			</div>

			<div class="ordersTable">
				<div class='orderRow head'>
					<div class="cell"></div>
				</div>


				<div class='toolsSide'>
					<button id="addOrder" onclick="EditOrder(CreateNewOrder())" title="Add a new production order">
						<span class="ico"><svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960"
								width="24px" fill="#e3e3e3">
								<path
									d="M440-280h80v-160h160v-80H520v-160h-80v160H280v80h160v160Zm40 200q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-80q134 0 227-93t93-227q0-134-93-227t-227-93q-134 0-227 93t-93 227q0 134 93 227t227 93Zm0-320Z" />
							</svg>
							<span class="keyInfo">(CTRL+C)</span>
						</span>
					</button>
					<button id="pauseAll" onclick="PauseAllTasks()" title="Pause/Unpause all production orders">
						<span class='ico'>
							<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px"
								fill="#e3e3e3">
								<path
									d="M360-320h80v-320h-80v320Zm160 0h80v-320h-80v320ZM480-80q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-80q134 0 227-93t93-227q0-134-93-227t-227-93q-134 0-227 93t-93 227q0 134 93 227t227 93Zm0-320Z" />
							</svg>
							<span class="keyInfo">(CTRL+A)</span>
						</span>
					</button>
					<button id="ordersSwapToolSide" onclick="ToggleOption('StocksToolsSide')" title="Swap toolbar side">
						<span class='ico'>
							<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px"
								fill="#e3e3e3">
								<path
									d="M280-160 80-360l200-200 56 57-103 103h287v80H233l103 103-56 57Zm400-240-56-57 103-103H440v-80h287L624-743l56-57 200 200-200 200Z" />
							</svg>
							<span class="keyInfo">(CTRL+G)</span>
						</span>
					</button>

					<div class="sep"> </div>

					<button id="sizeMode" onclick="CycleSizeMode()" title="Cycle interface size mode">
						<span class='ico'>
							<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px"
								fill="#e3e3e3">
								<path
									d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l252 252-56 56ZM380-400q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Zm-40-60v-80h-80v-80h80v-80h80v80h80v80h-80v80h-80Z" />
							</svg>
							<span class="keyInfo">(CTRL+Q)</span>
						</span>
					</button>
					<button id="extraCols" onclick="ToggleOption('LessColumns')" title="Show/hide optional columns">
						<span class='ico'>
							<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px"
								fill="#e3e3e3">
								<path
									d="M160-160q-33 0-56.5-23.5T80-240v-480q0-33 23.5-56.5T160-800h640q33 0 56.5 23.5T880-720v480q0 33-23.5 56.5T800-160H160Zm0-80h160v-480H160v480Zm240 0h160v-480H400v480Zm240 0h160v-480H640v480Zm-240 0v-480 480Z" />
							</svg>
							<span class="keyInfo">(CTRL+F)</span>
						</span>
					</button>

				</div>
			</div>

		</div>


		<div class="boardMode hidden">

			<div class='tools'>
				<button id="readStocks" onclick="ReadStocksBatch()" title="Read stocks from Dwarf Fortress">
					<span class='ico'>â¯ˆ</span>
					<span class='txt'>READ</span>
					<span class="keyInfo">(CTRL+R)</span>
				</button>
				<button id="autoReadStocks" onclick="ToggleOption('AutoReadStocks')"
					title="Toggle automatic reading of stocks from Dwarf Fortress">
					<span class='ico'><svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960"
							width="24px" fill="#e3e3e3">
							<path
								d="M204-318q-22-38-33-78t-11-82q0-134 93-228t227-94h7l-64-64 56-56 160 160-160 160-56-56 64-64h-7q-100 0-170 70.5T240-478q0 26 6 51t18 49l-60 60ZM481-40 321-200l160-160 56 56-64 64h7q100 0 170-70.5T720-482q0-26-6-51t-18-49l60-60q22 38 33 78t11 82q0 134-93 228t-227 94h-7l64 64-56 56Z" />
						</svg></span>
					<span class="keyInfo">(SHIFT+CTRL+R)</span>
				</button>

				<div class="sep"> </div>

				<button id="sizeMode" onclick="CycleSizeMode()" title="Cycle interface size mode">
					<span class='ico'>
						<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px"
							fill="#e3e3e3">
							<path
								d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l252 252-56 56ZM380-400q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Zm-40-60v-80h-80v-80h80v-80h80v80h80v80h-80v80h-80Z" />
						</svg>
					</span>
				</button>
			</div>

			<div class="boardMaterialsPickerHost hidden">
				<div class='bg'> </div>
				<div class="boardMaterialsPicker">
					<div class='filter'></span><input class='autofocus' id="boardMaterialsFilter"
							placeholder="Filter..." type="text" onclick="this.value='';BoardMaterialsFilterChanged('')"
							onfocus="this.value='';BoardMaterialsFilterChanged('')"
							onchange="BoardMaterialsFilterChanged(this.value)"
							onkeyup="BoardMaterialsFilterChanged(this.value)" />
						<button onclick="ClearStocksMaterialsFilter()" title="Clear selected materials">
							<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" height="24px"
									viewBox="0 -960 960 960" width="24px" fill="#e3e3e3">
									<path
										d="M280-120q-33 0-56.5-23.5T200-200v-520h-40v-80h200v-40h240v40h200v80h-40v520q0 33-23.5 56.5T680-120H280Zm400-600H280v520h400v-520ZM360-280h80v-360h-80v360Zm160 0h80v-360h-80v360ZM280-720v520-520Z" />
								</svg>
							</span>
							<span class="keyInfo">(CTRL+X)</span>
						</button>
					</div>
					<div class='materialsList hozScroll'></div>
				</div>
			</div>

			<div class="boardContent" onmouseup="event.stopPropagation();">
				<div class="boardTableHeader"></div>
				<div class="boardTable">
					<div class="boardBody">
						<div class="itemsSide"></div>
						<div class="valuesSide"></div>
					</div>
				</div>
			</div>

		</div>
	</div>



	<div class="orderEditor hidden" onmouseup="event.stopPropagation();">
		<div class="background"></div>
		<div class='window'>
			<h3>Production Order</h3>
			<label for="itemName"> <span>Item Name</span> <input forcePick="true" onchange="OrderEdited(this)"
					type="text" id="itemName" onfocus="SetAutoFill(this,Object.values(gameInfo.itemTypes))"
					onblur="CloseAutoFill(this)" />
				<div class="autocompleteList"></div>
			</label>
			<label for="itemType"> <span>Item Type</span> <input onchange="OrderEdited(this)" type="text" id="itemType"
					onfocus="SetAutoFill(this,Object.keys(gameInfo.items))" onblur="CloseAutoFill(this)" />
				<div class="autocompleteList"></div>
			</label>
			<label for="job"><span>Job</span><input onchange="OrderEdited(this)" type="text" id="job"
					onfocus="SetAutoFill(this,jobs)" onblur="CloseAutoFill(this)" />
				<div class="autocompleteList"></div>
			</label>
			<label for="matCat"> <span>Material</span> <input onchange="OrderEdited(this)" type="text" id="matCat"
					onfocus="SetAutoFill(this,Object.values(gameInfo.job_material_category))"
					onblur="CloseAutoFill(this)" />
				<div class="autocompleteList"></div>
			</label>
			<label for="material"><span>Specific material</span><input onchange="OrderEdited(this)" type="text"
					id="material" onfocus="SetAutoFill(this,gameInfo.materials)" onblur="CloseAutoFill(this)" />
				<div class="autocompleteList"></div>
			</label>
		</div>
	</div>

	<div class="conditionEditor hidden" onclick="event.stopPropagation();">
		<div class="background"> </div>
		<div class='window'>
			<h3 id="conditionEditorTitle">Production Condition</h3>
			<label for="itemType"> <span>Item</span> <input onchange="ConditionEdited(this)" type="text" id="itemType"
					onfocus="SetAutoFill(this,'itemTypes')" property="item_type" onblur="CloseAutoFill(this);" />
				<div class="autocompleteList"></div>
			</label>
			<label for="itemFlag"><span>Flag</span><input onchange="ConditionEdited(this)" type="text" id="itemFlag"
					onfocus="SetAutoFill(this,'flags',true)" property="flags" onblur="CloseAutoFill(this);" />
				<div class="autocompleteList"></div>
			</label>
			<label for="itemMaterial"><span>Material</span><input onchange="ConditionEdited(this)" type="text"
					id="itemMaterial" onfocus="SetAutoFill(this,'materials')" property="material"
					onblur="CloseAutoFill(this)" />
				<div class="autocompleteList"></div>
			</label>
			<label for="itemReactable"><span>Used for</span><input onchange="ConditionEdited(this)" type="text"
					id="itemReactable" onfocus="SetAutoFill(this,'reactions')" property="reaction_product"
					onblur="CloseAutoFill(this)" />
				<div class="autocompleteList"></div>
			</label>

			<label for="operator"><span>Comparison</span>
				<select id="operator" onchange="ConditionEdited(this)" property="condition">
					<option value="LessThan">&lt;</option>
					<option value="AtMost">&lt;=</option>
					<option value="Exactly">==</option>
					<option value="Not">!=</option>
					<option value="AtLeast">&gt;=</option>
					<option value="GreaterThan">&gt;</option>
				</select>
				<input type="number" id="conditionValue" value="0" onchange="ConditionEdited(this)" property="value" />
			</label>
		</div>
	</div>

</body>

</html>